<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beginner Programming Problems</title>
    <link rel="stylesheet" href="./style2.css">
    <link rel="stylesheet" href="./blog.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="./style.css">
    <style>
        .blog-item { border: 1px solid #ccc; padding: 15px; margin: 15px 0; }
        .comment-style { margin-top: 10px; font-style: italic; }
        .append-comments p { margin: 5px 0; }
    </style>
</head>
<body>
<div class="container-inner-blog">
    <div class="navbar">
       <div class="logo">MarwanðŸ˜œ</div>
       <div class="nav-featuer" id="nav-featuer">
           <div class="close" id="close"><i class="fa-solid fa-xmark"></i></div>
           <ul>
               <li><a href="./index.html">home</a></li>
               <li><a href="#C2">about</a></li>
               <li><a href="#C3">work</a></li>
               <li><a href="#C4">contact</a></li>
               <li><a href="./index2.html">blog</a></li>
           </ul>
       </div>
       <div class="hambrgar" id="hambrgar"><i class="fa-solid fa-bars"></i></div>
   </div>

    <main id="blog-container">
        <p>loading blogs.....</p>
    </main>
</div>

<script>
const blogContainer = document.getElementById('blog-container');

document.addEventListener("DOMContentLoaded", async () => {
    try {
        const res = await fetch('http://localhost:3000/api/blog/blog');
        const blogs = await res.json();

        if (!blogs.length) {
            blogContainer.innerHTML = "<p>No blogs are available</p>";
            return;
        }

        blogContainer.innerHTML = blogs.map(blog => `
            <div class="blog-item">
                <h2>${blog.title}</h2>
                <p>${blog.content}</p>
                <div class="comment-style">
                    <i>Comments: ${blog.Comment.length}</i> |
                    <i>Likes: ${blog.likes}</i>
                </div>

                <form class="commentForm">
                    <input type="text" name="comment" placeholder="Write a comment..." required  id="commentForm"/>
                    <button type="submit">Comment</button>
                </form>
                <div class="append-comments"></div>
            </div>
        `).join("");
        const commmentForm= document.getElementById('commentForm').value;

        blogContainer.addEventListener('submit',async (e) => {
            e.preventDefault()
            const blog_id=await {new: true}
          fetch('http://localhost:3000/api/comment/create',{
            method:"post",
            body:{
                title:commmentForm,
                // blog_id: blog._id
            }
          })
          console.log(commmentForm)
        });

    } catch (error) {
        console.error("Network error:", error);
        blogContainer.innerHTML = "<p>Failed to load blogs</p>";
    }
});
</script>
</body>
</html>
